# My muttrc.  Lots of documentation is in muttrc(5).

# Configure native IMAP support.  http://dev.mutt.org/trac/wiki/UseCases/Gmail
# http://wiki.archlinux.org/index.php/Mutt#Native_IMAP_support
set imap_user=lb.waym@gmail.com
set folder=imaps://imap.gmail.com/ # http://dev.mutt.org/trac/wiki/MuttGuide/Folders
set spoolfile=+INBOX
set copy=no # Don't save copies of outgoing messages (Gmail already saves them).
set postponed=+[Gmail]/Drafts # Save drafts remotely.
set imap_check_subscribed # Check all subscribed IMAP folders.

# Configure native SMTP support.
set realname="Lukas Waymann"
set from=lb.waym@gmail.com
set smtp_url=smtps://lb.waym@smtp.gmail.com
set ssl_force_tls

# Default is "us-ascii:iso-8859-1:utf-8".  Really?
# http://wiki.archlinux.org/index.php/Mutt#E-mail_character_encoding
set send_charset="utf-8"

# Configure GnuPG. From /var/log/pacman.log:
# [2014-03-23 01:32] [PACMAN] Running 'pacman -S mutt'
# [2014-03-23 01:32] [ALPM-SCRIPTLET]
# [2014-03-23 01:32] [ALPM-SCRIPTLET] ==> For GPG support, add the following to your muttrc:
# [2014-03-23 01:32] [ALPM-SCRIPTLET] ==> source /etc/Muttrc.gpg.dist
# [2014-03-23 01:32] [ALPM-SCRIPTLET]
source /etc/Muttrc.gpg.dist
# We need to change some variables from Muttrc.gpg.dist to also include
# "--pinentry-mode loopback" and/or "--encrypt-to 0xC4592C12" (so I can read my own sent
# mail).  Other than that, the commands are the same as in /etc/Muttrc.gpg.dist.
set pgp_decode_command="gpg --status-fd=2 %?p?--passphrase-fd 0 --pinentry-mode loopback? --no-verbose --quiet --batch --output - %f"
set pgp_decrypt_command="gpg --status-fd=2 %?p?--passphrase-fd 0 --pinentry-mode loopback? --no-verbose --quiet --batch --output - %f"
set pgp_sign_command="gpg --no-verbose --batch --quiet --output - %?p?--passphrase-fd 0 --pinentry-mode loopback? --armor --detach-sign --textmode %?a?-u %a? %f"
set pgp_clearsign_command="gpg --no-verbose --batch --quiet --output - %?p?--passphrase-fd 0 --pinentry-mode loopback? --armor --textmode --clearsign %?a?-u %a? %f"
# Add "--encrypt-to 0xC4592C12" so I can read my own sent mail.  Other than that, the commands
set pgp_encrypt_only_command="pgpewrap gpg --batch --quiet --no-verbose --output - --encrypt --textmode --armor --always-trust --encrypt-to 0xC4592C12 -- -r %r -- %f"
set pgp_encrypt_sign_command="pgpewrap gpg %?p?--passphrase-fd 0 --pinentry-mode loopback? --batch --quiet --no-verbose --textmode --output - --encrypt --sign %?a?-u %a? --armor --always-trust --encrypt-to 0xC4592C12 -- -r %r -- %f"
set crypt_autosign # Always attempt to cryptographically sign outgoing messages.
set pgp_sign_as="C4592C12"

# Get a signature from the message of the day.
set signature="cat /etc/motd|"

set abort_nosubject=no
set abort_unmodified=no

# set alias_file="~/.mutt/aliases"
# source $alias_file

# Copied from http://gitlab.com/goobook/goobook.
set query_command="goobook query '%s'"
bind editor <Tab> complete-query
macro index,pager a "<pipe-message>goobook add<return>" \
   "add the sender address to Google Contacts"

# https://wiki.archlinux.org/index.php/Mutt#Viewing_HTML
set mailcap_path="~/.mutt/mailcap"
auto_view text/html
auto_view application/pdf
alternative_order text/plain text/html # Prefer viewing plain text if available.

# macro attach V "<pipe-entry>cat >~/.mutt/mail.html && chromium ~/.mutt/mail.html<enter>"

# source ~/dotfiles/mutt/mutt-colors-solarized/mutt-colors-solarized-dark-256.muttrc
source ~/dotfiles/mutt/vombatidae-mutt/vombatidae.mutt

# vim: tw=90 sts=-1 sw=3 et nowrap
